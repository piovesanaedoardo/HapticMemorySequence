---
title: "CV3_HMS"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# librerie
library("jsonlite")
library("dplyr")
library("tidyr")
library("tidyverse")
library("data.table")
library("xlsx")
library("readxl")
library("gapminder")
library("convertr")
library("zoo")
library("magrittr") 
```

```{r}
## ------------------- U01CV3 -------------------
## copio dati da JSON
U01CV3 <- as_tibble(fromJSON("G:/Il mio Drive/Università/20_21_Tesi/JSON/CV/HapticMemorySequenceLog_2021_11_03_13_59_40_U01.json"))

## creo tabella contenente i movimenti della scatola rossa
objInTheBoxU01CV3<-U01CV3[[1]][[1]]

## creo tabella contenente i movimenti degli oggetti
objectsPositionU01CV3<-U01CV3[[2]][[1]]
View(objectsPositionU01CV3)
objectsPositionU01CV3$Utente <- "U01CV" # aggiungo colonna con nome utente

## tabella primo e ultimo movimento per calcolare inizio e fine (1)
inizioFineU01CV3 <- objectsPositionU01CV3 %>%
  group_by(Utente) %>%
  slice(c(1, n())) %>%
  ungroup() %>%
  select(Utente, timestamp)  # fin qua funziona tutto

# creo file con primo e ultimo movimento
write.csv(inizioFineU01CV3, "C:/Users/Edoardo/Documents/HapticMemorySequence/inizioFineU01CV3.csv", row.names = FALSE)

# copio e incollo in "U01CV" modifico a mano, mettendo su una riga e sostituisco / con :

# U01CV.csv contiene nome, inizio, fine
U01CV <- read.csv("U01CV.csv", encoding = "UTF-8")
View(U01CV)

## creo tabella per ogni oggetto
cylinderU01CV3 <- objectsPositionU01CV3[objectsPositionU01CV3$objPosition %like% "Cylinder", ]
cylinderU01CV3$Utente <- "U01CV"
## controllo ultima posizione
U01CV3_check_cylinder <- tail(cylinderU01CV3, n = 1)

cubeU01CV3 <- objectsPositionU01CV3[objectsPositionU01CV3$objPosition %like% "Cube", ]
## controllo ultima posizione
U01CV3_check_cube <- tail(cubeU01CV3, n = 1)

sphereU01CV3 <- objectsPositionU01CV3[objectsPositionU01CV3$objPosition %like% "Sphere", ]
## controllo ultima posizione
U01CV3_check_sphere <- tail(sphereU01CV3, n = 1)

U01CV3_check_total <- rbind(U01CV3_check_cylinder, U01CV3_check_cube, U01CV3_check_sphere)

# magie sulla tab
objPosU01CV <- U01CV3_check_total %>%
  separate(objPosition, into = c("object", "position"), sep = " ", convert =  TRUE) %>%
    spread(key = object, value = position) %>%
  select(Utente, 'Cube(Clone)', 'Cylinder(Clone)', 'Sphere(Clone)') %>%
  group_by(Utente) %>%
    mutate_all(funs(na.locf(., na.rm = FALSE, fromLast = FALSE))) %>%filter(row_number()==n())

colnames(objPosU01CV) <- c("Utente", "Cube", "Cylinder", "Sphere")

# unisco U01CV.csv creato prima con objPosU01CV
U01CV3_final <- inner_join(objPosU01CV, U01CV, by="Utente")
U01CV3_final %>%
  select(Utente, Inizio, Fine, Cube, Cylinder, Sphere)

# scrivo il file xlsx
write.xlsx(U01CV3_final, file = "CV3_final.xlsx", sheetName="U01CV3_final", append=TRUE)
```

```{r}
## ------------------- U02CV3 -------------------
## copio dati da JSON
U02CV3 <- as_tibble(fromJSON("G:/Il mio Drive/Università/20_21_Tesi/JSON/CV/HapticMemorySequenceLog_2021_11_03_15_29_10_U02.json"))

## creo tabella contenente i movimenti della scatola rossa
objInTheBoxU02CV3<-U02CV3[[1]][[1]]

## creo tabella contenente le posizioni iniziali e finali degli oggetti
objectsPositionU02CV3<-U02CV3[[2]][[1]]
objectsPositionU02CV3$Utente <- "U02CV"

## tabella primo e ultimo movimento per calcolare inizio e fine (1)
inizioFineU02CV3 <- objectsPositionU02CV3 %>%
  group_by(Utente) %>%
  slice(c(1, n())) %>%
  ungroup() %>%
  select(Utente, timestamp)  # fin qua funziona tutto

# creo file con primo e ultimo movimento
write.csv(inizioFineU02CV3, "C:/Users/Edoardo/Documents/HapticMemorySequence/inizioFineU02CV3.csv", row.names = FALSE)

# copio e incollo in "U02CV.csv" modifico a mano, mettendo su una riga e sostituisco / con :

# U02CV.csv contiene nome, inizio, fine
U02CV <- read.csv("U02CV.csv", encoding = "UTF-8")
View(U02CV)

## creo tabella per ogni oggetto
cylinderU02CV3 <- objectsPositionU02CV3[objectsPositionU02CV3$objPosition %like% "Cylinder", ]
cylinderU02CV3$Utente <- "U02CV"
## controllo ultima posizione
U02CV3_check_cylinder <- tail(cylinderU02CV3, n = 1)

cubeU02CV3 <- objectsPositionU02CV3[objectsPositionU02CV3$objPosition %like% "Cube", ]
## controllo ultima posizione
U02CV3_check_cube <- tail(cubeU02CV3, n = 1)

sphereU02CV3 <- objectsPositionU02CV3[objectsPositionU02CV3$objPosition %like% "Sphere", ]
## controllo ultima posizione
U02CV3_check_sphere <- tail(sphereU02CV3, n = 1)

U02CV3_check_total <- rbind(U02CV3_check_cylinder, U02CV3_check_cube, U02CV3_check_sphere)

# magie sulla tab
objPosU02CV <- U02CV3_check_total %>%
  separate(objPosition, into = c("object", "position"), sep = " ", convert =  TRUE) %>%
    spread(key = object, value = position) %>%
  select(Utente, 'Cube(Clone)', 'Cylinder(Clone)', 'Sphere(Clone)') %>%
  group_by(Utente) %>%
    mutate_all(funs(na.locf(., na.rm = FALSE, fromLast = FALSE))) %>%filter(row_number()==n())

colnames(objPosU02CV) <- c("Utente", "Cube", "Cylinder", "Sphere")

# unisco U02CV.csv creato prima con objPosU02CV
U02CV3_final <- inner_join(objPosU02CV, U02CV, by="Utente")
U02CV3_final %>%
  select(Utente, Inizio, Fine, Cube, Cylinder, Sphere)

# scrivo il file xlsx
write.xlsx(U02CV3_final, file = "CV3_final.xlsx", sheetName="U02CV3_final", append=TRUE)
```

```{r}
## ------------------- U03CV3 -------------------
## copio dati da JSON
U03CV3 <- as_tibble(fromJSON("G:/Il mio Drive/Università/20_21_Tesi/JSON/CV/HapticMemorySequenceLog_2021_11_03_16_04_50_U03.json"))

## creo tabella contenente i movimenti della scatola rossa
objInTheBoxU03CV3<-U03CV3[[1]][[1]]

## creo tabella contenente le posizioni iniziali e finali degli oggetti
objectsPositionU03CV3<-U03CV3[[2]][[1]]
objectsPositionU03CV3$Utente <- "U03CV"

## tabella primo e ultimo movimento per calcolare inizio e fine (1)
inizioFineU03CV3 <- objectsPositionU03CV3 %>%
  group_by(Utente) %>%
  slice(c(1, n())) %>%
  ungroup() %>%
  select(Utente, timestamp)  # fin qua funziona tutto

# creo file con primo e ultimo movimento
write.csv(inizioFineU03CV3, "C:/Users/Edoardo/Documents/HapticMemorySequence/inizioFineU03CV3.csv", row.names = FALSE)

# copio e incollo in "U03CV" modifico a mano, mettendo su una riga e sostituisco / con :

```

```{r}
# U03CV.csv contiene nome, inizio, fine
U03CV <- read.csv("U03CV.csv", encoding = "UTF-8")
View(U03CV)

## creo tabella per ogni oggetto
cylinderU03CV3 <- objectsPositionU03CV3[objectsPositionU03CV3$objPosition %like% "Cylinder", ]
cylinderU03CV3$Utente <- "U03CV"
## controllo ultima posizione
U03CV3_check_cylinder <- tail(cylinderU03CV3, n = 1)

cubeU03CV3 <- objectsPositionU03CV3[objectsPositionU03CV3$objPosition %like% "Cube", ]
## controllo ultima posizione
U03CV3_check_cube <- tail(cubeU03CV3, n = 1)

sphereU03CV3 <- objectsPositionU03CV3[objectsPositionU03CV3$objPosition %like% "Sphere", ]
## controllo ultima posizione
U03CV3_check_sphere <- tail(sphereU03CV3, n = 1)

U03CV3_check_total <- rbind(U03CV3_check_cylinder, U03CV3_check_cube, U03CV3_check_sphere)

# magie sulla tab
objPosU03CV <- U03CV3_check_total %>%
  separate(objPosition, into = c("object", "position"), sep = " ", convert =  TRUE) %>%
    spread(key = object, value = position) %>%
  select(Utente, 'Cube(Clone)', 'Cylinder(Clone)', 'Sphere(Clone)') %>%
  group_by(Utente) %>%
    mutate_all(funs(na.locf(., na.rm = FALSE, fromLast = FALSE))) %>%filter(row_number()==n())

colnames(objPosU03CV) <- c("Utente", "Cube", "Cylinder", "Sphere")
```

```{r}
# unisco U03CV.csv creato prima con objPosU03CV
U03CV3_final <- inner_join(objPosU03CV, U03CV, by="Utente")
U03CV3_final %>%
  select(Utente, Inizio, Fine, Cube, Cylinder, Sphere)

# scrivo il file xlsx
write.xlsx(U03CV3_final, file = "CV3_final.xlsx", sheetName="U03CV32_final", append=TRUE)

```


```{r}
## ------------------- U04CV3 -------------------
## copio dati da JSON
U04CV3 <- as_tibble(fromJSON("G:/Il mio Drive/Università/20_21_Tesi/JSON/CV/HapticMemorySequenceLog_2021_11_04_09_33_26_U04.json"))

## creo tabella contenente i movimenti della scatola rossa
objInTheBoxU04CV3<-U04CV3[[1]][[1]]

## creo tabella contenente le posizioni iniziali e finali degli oggetti
objectsPositionU04CV3<-U04CV3[[2]][[1]]
objectsPositionU04CV3$Utente <- "U04CV"

## tabella primo e ultimo movimento per calcolare inizio e fine (1)
inizioFineU04CV3 <- objectsPositionU04CV3 %>%
  group_by(Utente) %>%
  slice(c(1, n())) %>%
  ungroup() %>%
  select(Utente, timestamp)  # fin qua funziona tutto

# creo file con primo e ultimo movimento
write.csv(inizioFineU04CV3, "C:/Users/Edoardo/Documents/HapticMemorySequence/inizioFineU04CV3.csv", row.names = FALSE)

# copio e incollo "inizioFineU04CV3.csv" in "U04CV" modifico a mano, mettendo su una riga e sostituisco / con :

```

```{r}
# copio e incollo in "U04CV.csv" modifico a mano, mettendo su una riga e sostituisco / con :
# U04CV.csv contiene nome, inizio, fine
U04CV <- read.csv("U04CV.csv", encoding = "UTF-8")
View(U04CV)

## creo tabella per ogni oggetto
cylinderU04CV3 <- objectsPositionU04CV3[objectsPositionU04CV3$objPosition %like% "Cylinder", ]
cylinderU04CV3$Utente <- "U04CV"
## controllo ultima posizione
U04CV3_check_cylinder <- tail(cylinderU04CV3, n = 1)

cubeU04CV3 <- objectsPositionU04CV3[objectsPositionU04CV3$objPosition %like% "Cube", ]
## controllo ultima posizione
U04CV3_check_cube <- tail(cubeU04CV3, n = 1)

sphereU04CV3 <- objectsPositionU04CV3[objectsPositionU04CV3$objPosition %like% "Sphere", ]
## controllo ultima posizione
U04CV3_check_sphere <- tail(sphereU04CV3, n = 1)

U04CV3_check_total <- rbind(U04CV3_check_cylinder, U04CV3_check_cube, U04CV3_check_sphere)

# magie sulla tab
objPosU04CV <- U04CV3_check_total %>%
  separate(objPosition, into = c("object", "position"), sep = " ", convert =  TRUE) %>%
    spread(key = object, value = position) %>%
  select(Utente, 'Cube(Clone)', 'Cylinder(Clone)', 'Sphere(Clone)') %>%
  group_by(Utente) %>%
    mutate_all(funs(na.locf(., na.rm = FALSE, fromLast = FALSE))) %>%filter(row_number()==n())

colnames(objPosU04CV) <- c("Utente", "Cube", "Cylinder", "Sphere")
```

```{r}
# unisco U04CV.csv creato prima con objPosU04CV
U04CV3_final <- inner_join(objPosU04CV, U04CV, by="Utente")
U04CV3_final %>%
  select(Utente, Inizio, Fine, Cube, Cylinder, Sphere)

# scrivo il file xlsx
write.xlsx(U04CV3_final, file = "CV3_final.xlsx", sheetName="U04CV3_final", append=TRUE)

```

```{r}
## ------------------- U05CV3 -------------------
## copio dati da JSON
U05CV3 <- as_tibble(fromJSON("G:/Il mio Drive/Università/20_21_Tesi/JSON/CV/HapticMemorySequenceLog_2021_11_04_10_32_15_U05.json"))

## creo tabella contenente i movimenti della scatola rossa
objInTheBoxU05CV3<-U05CV3[[1]][[1]]

## creo tabella contenente le posizioni iniziali e finali degli oggetti
objectsPositionU05CV3<-U05CV3[[2]][[1]]
objectsPositionU05CV3$Utente <- "U05CV"

## tabella primo e ultimo movimento per calcolare inizio e fine (1)
inizioFineU05CV3 <- objectsPositionU05CV3 %>%
  group_by(Utente) %>%
  slice(c(1, n())) %>%
  ungroup() %>%
  select(Utente, timestamp)  # fin qua funziona tutto

# creo file con primo e ultimo movimento
write.csv(inizioFineU05CV3, "C:/Users/Edoardo/Documents/HapticMemorySequence/inizioFineU05CV3.csv", row.names = FALSE)
```

```{r}
# copio e incollo in "U05CV.csv" modifico a mano, mettendo su una riga e sostituisco / con :
# U05CV.csv contiene nome, inizio, fine
U05CV <- read.csv("U05CV.csv", encoding = "UTF-8")
View(U05CV)

## creo tabella per ogni oggetto
cylinderU05CV3 <- objectsPositionU05CV3[objectsPositionU05CV3$objPosition %like% "Cylinder", ]
cylinderU05CV3$Utente <- "U05CV"
## controllo ultima posizione
U05CV3_check_cylinder <- tail(cylinderU05CV3, n = 1)

cubeU05CV3 <- objectsPositionU05CV3[objectsPositionU05CV3$objPosition %like% "Cube", ]
## controllo ultima posizione
U05CV3_check_cube <- tail(cubeU05CV3, n = 1)

sphereU05CV3 <- objectsPositionU05CV3[objectsPositionU05CV3$objPosition %like% "Sphere", ]
## controllo ultima posizione
U05CV3_check_sphere <- tail(sphereU05CV3, n = 1)

U05CV3_check_total <- rbind(U05CV3_check_cylinder, U05CV3_check_cube, U05CV3_check_sphere)

# magie sulla tab
objPosU05CV <- U05CV3_check_total %>%
  separate(objPosition, into = c("object", "position"), sep = " ", convert =  TRUE) %>%
    spread(key = object, value = position) %>%
  select(Utente, 'Cube(Clone)', 'Cylinder(Clone)', 'Sphere(Clone)') %>%
  group_by(Utente) %>%
    mutate_all(funs(na.locf(., na.rm = FALSE, fromLast = FALSE))) %>%filter(row_number()==n())

colnames(objPosU05CV) <- c("Utente", "Cube", "Cylinder", "Sphere")
```

```{r}
# unisco U05CV.csv creato prima con objPosU05CV
U05CV3_final <- inner_join(objPosU05CV, U05CV, by="Utente")
U05CV3_final %>%
  select(Utente, Inizio, Fine, Cube, Cylinder, Sphere)

# scrivo il file xlsx
write.xlsx(U05CV3_final, file = "CV3_final.xlsx", sheetName="U05CV3_final", append=TRUE)

```

```{r}
## ------------------- U06CV3 -------------------
## copio dati da JSON
U06CV3 <- as_tibble(fromJSON("G:/Il mio Drive/Università/20_21_Tesi/JSON/CV/HapticMemorySequenceLog_2021_11_04_11_31_59_U06.json"))

## creo tabella contenente i movimenti della scatola rossa
objInTheBoxU06CV3<-U06CV3[[1]][[1]]

## creo tabella contenente le posizioni iniziali e finali degli oggetti
objectsPositionU06CV3<-U06CV3[[2]][[1]]
objectsPositionU06CV3$Utente <- "U06CV"

## tabella primo e ultimo movimento per calcolare inizio e fine (1)
inizioFineU06CV3 <- objectsPositionU06CV3 %>%
  group_by(Utente) %>%
  slice(c(1, n())) %>%
  ungroup() %>%
  select(Utente, timestamp)  # fin qua funziona tutto

# creo file con primo e ultimo movimento
write.csv(inizioFineU06CV3, "C:/Users/Edoardo/Documents/HapticMemorySequence/inizioFineU06CV3.csv", row.names = FALSE)
```

```{r}
# copio e incollo in "U06CV.csv" modifico a mano, mettendo su una riga e sostituisco / con :
# U06CV.csv contiene nome, inizio, fine
U06CV <- read.csv("U06CV.csv", encoding = "UTF-8")
View(U06CV)

## creo tabella per ogni oggetto
cylinderU06CV3 <- objectsPositionU06CV3[objectsPositionU06CV3$objPosition %like% "Cylinder", ]
cylinderU06CV3$Utente <- "U06CV"
## controllo ultima posizione
U06CV3_check_cylinder <- tail(cylinderU06CV3, n = 1)

cubeU06CV3 <- objectsPositionU06CV3[objectsPositionU06CV3$objPosition %like% "Cube", ]
## controllo ultima posizione
U06CV3_check_cube <- tail(cubeU06CV3, n = 1)

sphereU06CV3 <- objectsPositionU06CV3[objectsPositionU06CV3$objPosition %like% "Sphere", ]
## controllo ultima posizione
U06CV3_check_sphere <- tail(sphereU06CV3, n = 1)

U06CV3_check_total <- rbind(U06CV3_check_cylinder, U06CV3_check_cube, U06CV3_check_sphere)

# magie sulla tab
objPosU06CV <- U06CV3_check_total %>%
  separate(objPosition, into = c("object", "position"), sep = " ", convert =  TRUE) %>%
    spread(key = object, value = position) %>%
  select(Utente, 'Cube(Clone)', 'Cylinder(Clone)', 'Sphere(Clone)') %>%
  group_by(Utente) %>%
    mutate_all(funs(na.locf(., na.rm = FALSE, fromLast = FALSE))) %>%filter(row_number()==n())

colnames(objPosU06CV) <- c("Utente", "Cube", "Cylinder", "Sphere")
```

```{r}
# unisco U06CV.csv creato prima con objPosU06CV
U06CV3_final <- inner_join(objPosU06CV, U06CV, by="Utente")
U06CV3_final %>%
  select(Utente, Inizio, Fine, Cube, Cylinder, Sphere)

# scrivo il file xlsx
write.xlsx(U06CV3_final, file = "CV3_final.xlsx", sheetName="U06CV3_final", append=TRUE)

```

```{r}
## ------------------- U07CV3 -------------------
## copio dati da JSON
U07CV3 <- as_tibble(fromJSON("G:/Il mio Drive/Università/20_21_Tesi/JSON/CV/HapticMemorySequenceLog_2021_11_04_14_15_38_U07.json"))

## creo tabella contenente i movimenti della scatola rossa
objInTheBoxU07CV3<-U07CV3[[1]][[1]]

## creo tabella contenente le posizioni iniziali e finali degli oggetti
objectsPositionU07CV3<-U07CV3[[2]][[1]]
objectsPositionU07CV3$Utente <- "U07CV"

## tabella primo e ultimo movimento per calcolare inizio e fine (1)
inizioFineU07CV3 <- objectsPositionU07CV3 %>%
  group_by(Utente) %>%
  slice(c(1, n())) %>%
  ungroup() %>%
  select(Utente, timestamp)  # fin qua funziona tutto

# creo file con primo e ultimo movimento
write.csv(inizioFineU07CV3, "C:/Users/Edoardo/Documents/HapticMemorySequence/inizioFineU07CV3.csv", row.names = FALSE)
```

```{r}
# copio e incollo in "U07CV.csv" modifico a mano, mettendo su una riga e sostituisco / con :
# U07CV.csv contiene nome, inizio, fine
U07CV <- read.csv("U07CV.csv", encoding = "UTF-8")
View(U07CV)

## creo tabella per ogni oggetto
cylinderU07CV3 <- objectsPositionU07CV3[objectsPositionU07CV3$objPosition %like% "Cylinder", ]
cylinderU07CV3$Utente <- "U07CV"
## controllo ultima posizione
U07CV3_check_cylinder <- tail(cylinderU07CV3, n = 1)

cubeU07CV3 <- objectsPositionU07CV3[objectsPositionU07CV3$objPosition %like% "Cube", ]
## controllo ultima posizione
U07CV3_check_cube <- tail(cubeU07CV3, n = 1)

sphereU07CV3 <- objectsPositionU07CV3[objectsPositionU07CV3$objPosition %like% "Sphere", ]
## controllo ultima posizione
U07CV3_check_sphere <- tail(sphereU07CV3, n = 1)

U07CV3_check_total <- rbind(U07CV3_check_cylinder, U07CV3_check_cube, U07CV3_check_sphere)

# magie sulla tab
objPosU07CV <- U07CV3_check_total %>%
  separate(objPosition, into = c("object", "position"), sep = " ", convert =  TRUE) %>%
    spread(key = object, value = position) %>%
  select(Utente, 'Cube(Clone)', 'Cylinder(Clone)', 'Sphere(Clone)') %>%
  group_by(Utente) %>%
    mutate_all(funs(na.locf(., na.rm = FALSE, fromLast = FALSE))) %>%filter(row_number()==n())

colnames(objPosU07CV) <- c("Utente", "Cube", "Cylinder", "Sphere")
```

```{r}
# unisco U07CV.csv creato prima con objPosU07CV
U07CV3_final <- inner_join(objPosU07CV, U07CV, by="Utente")
U07CV3_final %>%
  select(Utente, Inizio, Fine, Cube, Cylinder, Sphere)

# scrivo il file xlsx
write.xlsx(U07CV3_final, file = "CV3_final.xlsx", sheetName="U07CV3_final", append=TRUE)

```

```{r}
## ------------------- U08CV3 -------------------
## copio dati da JSON
U08CV3 <- as_tibble(fromJSON("G:/Il mio Drive/Università/20_21_Tesi/JSON/CV/HapticMemorySequenceLog_2021_11_04_15_39_57_U08.json"))

## creo tabella contenente i movimenti della scatola rossa
objInTheBoxU08CV3<-U08CV3[[1]][[1]]

## creo tabella contenente le posizioni iniziali e finali degli oggetti
objectsPositionU08CV3<-U08CV3[[2]][[1]]
objectsPositionU08CV3$Utente <- "U08CV"

## tabella primo e ultimo movimento per calcolare inizio e fine (1)
inizioFineU08CV3 <- objectsPositionU08CV3 %>%
  group_by(Utente) %>%
  slice(c(1, n())) %>%
  ungroup() %>%
  select(Utente, timestamp)  # fin qua funziona tutto

# creo file con primo e ultimo movimento
write.csv(inizioFineU08CV3, "C:/Users/Edoardo/Documents/HapticMemorySequence/inizioFineU08CV3.csv", row.names = FALSE)
```

```{r}
# copio e incollo in "U08CV.csv" modifico a mano, mettendo su una riga e sostituisco / con :
# U08CV.csv contiene nome, inizio, fine
U08CV <- read.csv("U08CV.csv", encoding = "UTF-8")
View(U08CV)

## creo tabella per ogni oggetto
cylinderU08CV3 <- objectsPositionU08CV3[objectsPositionU08CV3$objPosition %like% "Cylinder", ]
cylinderU08CV3$Utente <- "U08CV"
## controllo ultima posizione
U08CV3_check_cylinder <- tail(cylinderU08CV3, n = 1)

cubeU08CV3 <- objectsPositionU08CV3[objectsPositionU08CV3$objPosition %like% "Cube", ]
## controllo ultima posizione
U08CV3_check_cube <- tail(cubeU08CV3, n = 1)

sphereU08CV3 <- objectsPositionU08CV3[objectsPositionU08CV3$objPosition %like% "Sphere", ]
## controllo ultima posizione
U08CV3_check_sphere <- tail(sphereU08CV3, n = 1)

U08CV3_check_total <- rbind(U08CV3_check_cylinder, U08CV3_check_cube, U08CV3_check_sphere)

# magie sulla tab
objPosU08CV <- U08CV3_check_total %>%
  separate(objPosition, into = c("object", "position"), sep = " ", convert =  TRUE) %>%
    spread(key = object, value = position) %>%
  select(Utente, 'Cube(Clone)', 'Cylinder(Clone)', 'Sphere(Clone)') %>%
  group_by(Utente) %>%
    mutate_all(funs(na.locf(., na.rm = FALSE, fromLast = FALSE))) %>%filter(row_number()==n())

colnames(objPosU08CV) <- c("Utente", "Cube", "Cylinder", "Sphere")
```

```{r}
# unisco U08CV.csv creato prima con objPosU08CV
U08CV3_final <- inner_join(objPosU08CV, U08CV, by="Utente")
U08CV3_final %>%
  select(Utente, Inizio, Fine, Cube, Cylinder, Sphere)

# scrivo il file xlsx
write.xlsx(U08CV3_final, file = "CV3_final.xlsx", sheetName="U08CV3_final", append=TRUE)

```

```{r}
## ------------------- U09CV3 -------------------
## copio dati da JSON
U09CV3 <- as_tibble(fromJSON("G:/Il mio Drive/Università/20_21_Tesi/JSON/CV/HapticMemorySequenceLog_2021_11_04_16_22_58_U09.json"))

## creo tabella contenente i movimenti della scatola rossa
objInTheBoxU09CV3<-U09CV3[[1]][[1]]

## creo tabella contenente le posizioni iniziali e finali degli oggetti
objectsPositionU09CV3<-U09CV3[[2]][[1]]
objectsPositionU09CV3$Utente <- "U09CV"

## tabella primo e ultimo movimento per calcolare inizio e fine (1)
inizioFineU09CV3 <- objectsPositionU09CV3 %>%
  group_by(Utente) %>%
  slice(c(1, n())) %>%
  ungroup() %>%
  select(Utente, timestamp)  # fin qua funziona tutto

# creo file con primo e ultimo movimento
write.csv(inizioFineU09CV3, "C:/Users/Edoardo/Documents/HapticMemorySequence/inizioFineU09CV3.csv", row.names = FALSE)
```

```{r}
# copio e incollo in "U09CV.csv" modifico a mano, mettendo su una riga e sostituisco / con :
# U09CV.csv contiene nome, inizio, fine
U09CV <- read.csv("U09CV.csv", encoding = "UTF-8")
View(U09CV)

## creo tabella per ogni oggetto
cylinderU09CV3 <- objectsPositionU09CV3[objectsPositionU09CV3$objPosition %like% "Cylinder", ]
cylinderU09CV3$Utente <- "U09CV"
## controllo ultima posizione
U09CV3_check_cylinder <- tail(cylinderU09CV3, n = 1)

cubeU09CV3 <- objectsPositionU09CV3[objectsPositionU09CV3$objPosition %like% "Cube", ]
## controllo ultima posizione
U09CV3_check_cube <- tail(cubeU09CV3, n = 1)

sphereU09CV3 <- objectsPositionU09CV3[objectsPositionU09CV3$objPosition %like% "Sphere", ]
## controllo ultima posizione
U09CV3_check_sphere <- tail(sphereU09CV3, n = 1)

U09CV3_check_total <- rbind(U09CV3_check_cylinder, U09CV3_check_cube, U09CV3_check_sphere)

# magie sulla tab
objPosU09CV <- U09CV3_check_total %>%
  separate(objPosition, into = c("object", "position"), sep = " ", convert =  TRUE) %>%
    spread(key = object, value = position) %>%
  select(Utente, 'Cube(Clone)', 'Cylinder(Clone)', 'Sphere(Clone)') %>%
  group_by(Utente) %>%
    mutate_all(funs(na.locf(., na.rm = FALSE, fromLast = FALSE))) %>%filter(row_number()==n())

colnames(objPosU09CV) <- c("Utente", "Cube", "Cylinder", "Sphere")
```

```{r}
# unisco U09CV.csv creato prima con objPosU09CV
U09CV3_final <- inner_join(objPosU09CV, U09CV, by="Utente")
U09CV3_final %>%
  select(Utente, Inizio, Fine, Cube, Cylinder, Sphere)

# scrivo il file xlsx
write.xlsx(U09CV3_final, file = "CV3_final.xlsx", sheetName="U09CV3_final", append=TRUE)

```

```{r}
## ------------------- U10CV3 -------------------
## copio dati da JSON
U10CV3 <- as_tibble(fromJSON("G:/Il mio Drive/Università/20_21_Tesi/JSON/CV/HapticMemorySequenceLog_2021_11_05_09_51_39_U10.json"))

## creo tabella contenente i movimenti della scatola rossa
objInTheBoxU10CV3<-U10CV3[[1]][[1]]

## creo tabella contenente le posizioni iniziali e finali degli oggetti
objectsPositionU10CV3<-U10CV3[[2]][[1]]
objectsPositionU10CV3$Utente <- "U10CV"

## tabella primo e ultimo movimento per calcolare inizio e fine (1)
inizioFineU10CV3 <- objectsPositionU10CV3 %>%
  group_by(Utente) %>%
  slice(c(1, n())) %>%
  ungroup() %>%
  select(Utente, timestamp)  # fin qua funziona tutto

# creo file con primo e ultimo movimento
write.csv(inizioFineU10CV3, "C:/Users/Edoardo/Documents/HapticMemorySequence/inizioFineU10CV3.csv", row.names = FALSE)
```

```{r}
# copio e incollo in "U10CV.csv" modifico a mano, mettendo su una riga e sostituisco / con :
# U10CV.csv contiene nome, inizio, fine
U10CV <- read.csv("U10CV.csv", encoding = "UTF-8")
View(U10CV)

## creo tabella per ogni oggetto
cylinderU10CV3 <- objectsPositionU10CV3[objectsPositionU10CV3$objPosition %like% "Cylinder", ]
cylinderU10CV3$Utente <- "U10CV"
## controllo ultima posizione
U10CV3_check_cylinder <- tail(cylinderU10CV3, n = 1)

cubeU10CV3 <- objectsPositionU10CV3[objectsPositionU10CV3$objPosition %like% "Cube", ]
## controllo ultima posizione
U10CV3_check_cube <- tail(cubeU10CV3, n = 1)

sphereU10CV3 <- objectsPositionU10CV3[objectsPositionU10CV3$objPosition %like% "Sphere", ]
## controllo ultima posizione
U10CV3_check_sphere <- tail(sphereU10CV3, n = 1)

U10CV3_check_total <- rbind(U10CV3_check_cylinder, U10CV3_check_cube, U10CV3_check_sphere)

# magie sulla tab
objPosU10CV <- U10CV3_check_total %>%
  separate(objPosition, into = c("object", "position"), sep = " ", convert =  TRUE) %>%
    spread(key = object, value = position) %>%
  select(Utente, 'Cube(Clone)', 'Cylinder(Clone)', 'Sphere(Clone)') %>%
  group_by(Utente) %>%
    mutate_all(funs(na.locf(., na.rm = FALSE, fromLast = FALSE))) %>%filter(row_number()==n())

colnames(objPosU10CV) <- c("Utente", "Cube", "Cylinder", "Sphere")
```

```{r}
# unisco U10CV.csv creato prima con objPosU10CV
U10CV3_final <- inner_join(objPosU10CV, U10CV, by="Utente")
U10CV3_final %>%
  select(Utente, Inizio, Fine, Cube, Cylinder, Sphere)

# scrivo il file xlsx
write.xlsx(U10CV3_final, file = "CV3_final.xlsx", sheetName="U10CV3_final", append=TRUE)

```

```{r}
## ------------------- U11CV3 -------------------
## copio dati da JSON
U11CV3 <- as_tibble(fromJSON("G:/Il mio Drive/Università/20_21_Tesi/JSON/CV/HapticMemorySequenceLog_2021_11_05_10_59_30_U11.json"))

## creo tabella contenente i movimenti della scatola rossa
objInTheBoxU11CV3<-U11CV3[[1]][[1]]

## creo tabella contenente le posizioni iniziali e finali degli oggetti
objectsPositionU11CV3<-U11CV3[[2]][[1]]
objectsPositionU11CV3$Utente <- "U11CV"

## tabella primo e ultimo movimento per calcolare inizio e fine (1)
inizioFineU11CV3 <- objectsPositionU11CV3 %>%
  group_by(Utente) %>%
  slice(c(1, n())) %>%
  ungroup() %>%
  select(Utente, timestamp)  # fin qua funziona tutto

# creo file con primo e ultimo movimento
write.csv(inizioFineU11CV3, "C:/Users/Edoardo/Documents/HapticMemorySequence/inizioFineU11CV3.csv", row.names = FALSE)
```

```{r}
# copio e incollo in "U11CV.csv" modifico a mano, mettendo su una riga e sostituisco / con :
# U11CV.csv contiene nome, inizio, fine
U11CV <- read.csv("U11CV.csv", encoding = "UTF-8")
View(U11CV)

## creo tabella per ogni oggetto
cylinderU11CV3 <- objectsPositionU11CV3[objectsPositionU11CV3$objPosition %like% "Cylinder", ]
cylinderU11CV3$Utente <- "U11CV"
## controllo ultima posizione
U11CV3_check_cylinder <- tail(cylinderU11CV3, n = 1)

cubeU11CV3 <- objectsPositionU11CV3[objectsPositionU11CV3$objPosition %like% "Cube", ]
## controllo ultima posizione
U11CV3_check_cube <- tail(cubeU11CV3, n = 1)

sphereU11CV3 <- objectsPositionU11CV3[objectsPositionU11CV3$objPosition %like% "Sphere", ]
## controllo ultima posizione
U11CV3_check_sphere <- tail(sphereU11CV3, n = 1)

U11CV3_check_total <- rbind(U11CV3_check_cylinder, U11CV3_check_cube, U11CV3_check_sphere)

# magie sulla tab
objPosU11CV <- U11CV3_check_total %>%
  separate(objPosition, into = c("object", "position"), sep = " ", convert =  TRUE) %>%
    spread(key = object, value = position) %>%
  select(Utente, 'Cube(Clone)', 'Cylinder(Clone)', 'Sphere(Clone)') %>%
  group_by(Utente) %>%
    mutate_all(funs(na.locf(., na.rm = FALSE, fromLast = FALSE))) %>%filter(row_number()==n())

colnames(objPosU11CV) <- c("Utente", "Cube", "Cylinder", "Sphere")
```

```{r}
# unisco U11CV.csv creato prima con objPosU11CV
U11CV3_final <- inner_join(objPosU11CV, U11CV, by="Utente")
U11CV3_final %>%
  select(Utente, Inizio, Fine, Cube, Cylinder, Sphere)

# scrivo il file xlsx
write.xlsx(U11CV3_final, file = "CV3_final.xlsx", sheetName="U11CV3_final", append=TRUE)

```

```{r}
## ------------------- U12CV3 -------------------
## copio dati da JSON
U12CV3 <- as_tibble(fromJSON("G:/Il mio Drive/Università/20_21_Tesi/JSON/CV/HapticMemorySequenceLog_2021_11_05_11_51_58_U12.json"))

## creo tabella contenente i movimenti della scatola rossa
objInTheBoxU12CV3<-U12CV3[[1]][[1]]

## creo tabella contenente le posizioni iniziali e finali degli oggetti
objectsPositionU12CV3<-U12CV3[[2]][[1]]
objectsPositionU12CV3$Utente <- "U12CV"

## tabella primo e ultimo movimento per calcolare inizio e fine (1)
inizioFineU12CV3 <- objectsPositionU12CV3 %>%
  group_by(Utente) %>%
  slice(c(1, n())) %>%
  ungroup() %>%
  select(Utente, timestamp)  # fin qua funziona tutto

# creo file con primo e ultimo movimento
write.csv(inizioFineU12CV3, "C:/Users/Edoardo/Documents/HapticMemorySequence/inizioFineU12CV3.csv", row.names = FALSE)
```

```{r}
# copio e incollo in "U12CV.csv" modifico a mano, mettendo su una riga e sostituisco / con :
# U12CV.csv contiene nome, inizio, fine
U12CV <- read.csv("U12CV.csv", encoding = "UTF-8")
View(U12CV)

## creo tabella per ogni oggetto
cylinderU12CV3 <- objectsPositionU12CV3[objectsPositionU12CV3$objPosition %like% "Cylinder", ]
cylinderU12CV3$Utente <- "U12CV"
## controllo ultima posizione
U12CV3_check_cylinder <- tail(cylinderU12CV3, n = 1)

cubeU12CV3 <- objectsPositionU12CV3[objectsPositionU12CV3$objPosition %like% "Cube", ]
## controllo ultima posizione
U12CV3_check_cube <- tail(cubeU12CV3, n = 1)

sphereU12CV3 <- objectsPositionU12CV3[objectsPositionU12CV3$objPosition %like% "Sphere", ]
## controllo ultima posizione
U12CV3_check_sphere <- tail(sphereU12CV3, n = 1)

U12CV3_check_total <- rbind(U12CV3_check_cylinder, U12CV3_check_cube, U12CV3_check_sphere)

# magie sulla tab
objPosU12CV <- U12CV3_check_total %>%
  separate(objPosition, into = c("object", "position"), sep = " ", convert =  TRUE) %>%
    spread(key = object, value = position) %>%
  select(Utente, 'Cube(Clone)', 'Cylinder(Clone)', 'Sphere(Clone)') %>%
  group_by(Utente) %>%
    mutate_all(funs(na.locf(., na.rm = FALSE, fromLast = FALSE))) %>%filter(row_number()==n())

colnames(objPosU12CV) <- c("Utente", "Cube", "Cylinder", "Sphere")
```

```{r}
# unisco U12CV.csv creato prima con objPosU12CV
U12CV3_final <- inner_join(objPosU12CV, U12CV, by="Utente")
U12CV3_final %>%
  select(Utente, Inizio, Fine, Cube, Cylinder, Sphere)

# scrivo il file xlsx
write.xlsx(U12CV3_final, file = "CV3_final.xlsx", sheetName="U12CV3_final", append=TRUE)

```

```{r}
## ------------------- tabella con risutltati di tutti gli utenti -------------------
objPosAllUsers <- rbind(objPosU01CV, objPosU02CV, objPosU03CV, 
                        objPosU04CV, objPosU05CV, objPosU06CV, 
                        objPosU07CV, objPosU08CV, objPosU09CV, 
                        objPosU10CV, objPosU11CV, objPosU12CV)

View(objPosAllUsers)


## ------------------- tabella con tutti gli utenti -------------------
CV3_allUsers <- rbind(U01CV3_check_total, U02CV3_check_total, U03CV3_check_total,
             U04CV3_check_total, U05CV3_check_total, U06CV3_check_total,
             U07CV3_check_total, U08CV3_check_total, U09CV3_check_total,
             U10CV3_check_total, U11CV3_check_total, U12CV3_check_total)

View(CV3_allUsers)

# Creo colonna "pos"
CV3_allUsers %>%
  select(Utente, objPosition) %>%
  mutate(Pos = case_when(
    endsWith(objPosition, "true") ~ 1,
    endsWith(objPosition, "false") ~ 0
  ))

write.xlsx(CV3_allUsers, file = "CV3_allUsers.xlsx",
           sheetName="CV3_allUsers", append=TRUE)
```

